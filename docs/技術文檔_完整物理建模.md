# â˜• æ‰‹æ²–å’–å•¡3Dæµé«”æ¨¡æ“¬æŠ€è¡“æ–‡æª”
## åŸºæ–¼Lattice Boltzmann Methodçš„å®Œæ•´ç‰©ç†å»ºæ¨¡èˆ‡ä¼æ¥­ç´šCFDç³»çµ±

> **å°ˆæ¡ˆæ¦‚è¿°**: å·¥æ¥­ç´š3D LBMæ–¹æ³•ç²¾ç¢ºæ¨¡æ“¬Hario V60æ‰‹æ²–å’–å•¡éç¨‹çš„å®Œæ•´æµé«”å‹•åŠ›å­¸  
> **ç³»çµ±æ¶æ§‹**: ä¼æ¥­ç´šæ¨¡çµ„åŒ–è¨­è¨ˆï¼ŒåŒ…å«Phase 3å¼·è€¦åˆç³»çµ±èˆ‡CFDå·¥ç¨‹å¸«ç´šåˆ†æåŠŸèƒ½  
> **é–‹ç™¼å·¥å…·**: opencode + GitHub Copilot  
> **è¨ˆç®—æ¡†æ¶**: Taichi GPUä¸¦è¡Œé‹ç®— + JAXæ··åˆè¨ˆç®—å¼•æ“  
> **ç‰ˆæœ¬ç‹€æ…‹**: v2.0 ä¼æ¥­ç´šé‡æ§‹ç‰ˆæœ¬

---

## ğŸ“‹ ç›®éŒ„

1. [ç‰©ç†å»ºæ¨¡åŸºç¤](#1-ç‰©ç†å»ºæ¨¡åŸºç¤)
2. [LBMç†è«–æ¨å°](#2-lbmç†è«–æ¨å°)
3. [ä¼æ¥­ç´šç³»çµ±æ¶æ§‹](#3-ä¼æ¥­ç´šç³»çµ±æ¶æ§‹)
4. [Phase 3å¼·è€¦åˆç³»çµ±](#4-phase-3å¼·è€¦åˆç³»çµ±)
5. [CFDå·¥ç¨‹å¸«ç´šåˆ†æ](#5-cfdå·¥ç¨‹å¸«ç´šåˆ†æ)
6. [å¹¾ä½•åƒæ•¸è¨­å®š](#6-å¹¾ä½•åƒæ•¸è¨­å®š)
7. [æµé«”ç‰©æ€§åƒæ•¸](#7-æµé«”ç‰©æ€§åƒæ•¸)
8. [å¤šç›¸æµå»ºæ¨¡](#8-å¤šç›¸æµå»ºæ¨¡)
9. [å¤šå­”ä»‹è³ªå»ºæ¨¡](#9-å¤šå­”ä»‹è³ªå»ºæ¨¡)
10. [æ•¸å€¼æ–¹æ³•](#10-æ•¸å€¼æ–¹æ³•)
11. [æ™‚é–“èˆ‡ç©ºé–“é›¢æ•£åŒ–](#11-æ™‚é–“èˆ‡ç©ºé–“é›¢æ•£åŒ–)
12. [é‚Šç•Œæ¢ä»¶](#12-é‚Šç•Œæ¢ä»¶)
13. [ç©©å®šæ€§åˆ†æ](#13-ç©©å®šæ€§åˆ†æ)
14. [é©—è­‰èˆ‡æ ¡æº–](#14-é©—è­‰èˆ‡æ ¡æº–)
15. [é«˜æ€§èƒ½è¨ˆç®—](#15-é«˜æ€§èƒ½è¨ˆç®—)

---

## 1. ç‰©ç†å»ºæ¨¡åŸºç¤

### 1.1 æ§åˆ¶æ–¹ç¨‹çµ„

å’–å•¡æ²–æ³¡éç¨‹æ¶‰åŠçš„ä¸»è¦ç‰©ç†ç¾è±¡ï¼š

#### **é€£çºŒæ€§æ–¹ç¨‹ (è³ªé‡å®ˆæ†)**
```math
âˆ‚Ï/âˆ‚t + âˆ‡Â·(Ïu) = 0
```

#### **å‹•é‡æ–¹ç¨‹ (Navier-Stokes)**
```math
âˆ‚(Ïu)/âˆ‚t + âˆ‡Â·(Ïuu) = -âˆ‡p + âˆ‡Â·[Î¼(âˆ‡u + (âˆ‡u)áµ€)] + Ïg + F_surface + F_porous
```

å…¶ä¸­ï¼š
- `Ï`: å¯†åº¦å ´
- `u`: é€Ÿåº¦å ´
- `p`: å£“åŠ›å ´
- `Î¼`: å‹•åŠ›ç²˜æ»¯åº¦
- `g`: é‡åŠ›åŠ é€Ÿåº¦
- `F_surface`: è¡¨é¢å¼µåŠ›
- `F_porous`: å¤šå­”ä»‹è³ªé˜»åŠ›

#### **ç›¸å ´æ–¹ç¨‹ (å¤šç›¸æµ)**
```math
âˆ‚Ï†/âˆ‚t + uÂ·âˆ‡Ï† = âˆ‡Â·[Mâˆ‡(âˆ‚f/âˆ‚Ï†)]
```

å…¶ä¸­ï¼š
- `Ï†`: ç›¸å ´è®Šæ•¸ (0=ç©ºæ°£, 1=æ°´)
- `M`: é·ç§»ç‡
- `f`: è‡ªç”±èƒ½å¯†åº¦å‡½æ•¸

### 1.2 ç„¡é‡ç¶±åˆ†æ

#### **é—œéµç„¡é‡ç¶±æ•¸ (ä¿®æ­£ç‰ˆ)**

**é›·è«¾æ•¸ (Reynolds Number)**: *ä¿®æ­£è¨ˆç®—*
```math
Re = ÏUL/Î¼ = 965.3 Ã— 0.05 Ã— 0.085 / (3.15Ã—10â»â· Ã— 965.3) â‰ˆ 1347
```

**éŸ‹ä¼¯æ•¸ (Weber Number)**:
```math
We = ÏUÂ²L/Ïƒ = 965.3 Ã— (0.05)Â² Ã— 0.085 / 0.073 â‰ˆ 1.74
```

**å¼—é­¯å¾·æ•¸ (Froude Number)**:
```math
Fr = U/âˆš(gL) = 0.05/âˆš(9.81 Ã— 0.085) â‰ˆ 0.055
```

**é”è¥¿æ•¸ (Darcy Number)**:
```math
Da = Îº/LÂ² = 1Ã—10â»â¸ mÂ² / (0.085 m)Â² â‰ˆ 1.38Ã—10â»â¶
```

**âš ï¸ é‡è¦ä¿®æ­£èªªæ˜**:
- **Reynoldsæ•¸**: å¾270ä¿®æ­£ç‚º1347 (æé«˜ç‰¹å¾µé€Ÿåº¦U=0.01â†’0.05 m/s)
- **æµå‹•ç‰¹æ€§**: Re=1347å±¬æ–¼**éæ¸¡æµå€åŸŸ**ï¼Œéœ€è¦æ¹æµå»ºæ¨¡
- **LESå¿…è¦æ€§**: Re > 500æ™‚å•Ÿç”¨LESäºæ ¼å­å°ºåº¦æ¨¡å‹

---

## 2. LBMç†è«–æ¨å°

### 2.1 Boltzmannæ–¹ç¨‹

#### **åŸºæœ¬Boltzmannæ–¹ç¨‹**
```math
âˆ‚f/âˆ‚t + Î¾Â·âˆ‡f + FÂ·âˆ‡_Î¾f = Î©(f)
```

å…¶ä¸­ï¼š
- `f(x,Î¾,t)`: åˆ†ä½ˆå‡½æ•¸
- `Î¾`: åˆ†å­é€Ÿåº¦
- `F`: å¤–åŠ›
- `Î©(f)`: ç¢°æ’ç®—å­

#### **BGKè¿‘ä¼¼**
```math
Î©(f) = -(f - f^eq)/Ï„
```

å…¶ä¸­ï¼š
- `f^eq`: å¹³è¡¡æ…‹åˆ†ä½ˆå‡½æ•¸
- `Ï„`: é¬†å¼›æ™‚é–“

### 2.2 é›¢æ•£åŒ–Boltzmannæ–¹ç¨‹

#### **D3Q19æ¨¡å‹**

**é€Ÿåº¦å‘é‡é›†**:
```python
# 19å€‹é›¢æ•£é€Ÿåº¦æ–¹å‘
c_0 = (0,0,0)                           # éœæ­¢
c_1-6 = (Â±1,0,0), (0,Â±1,0), (0,0,Â±1)   # 6å€‹é¢ä¸­å¿ƒ
c_7-18 = (Â±1,Â±1,0), (Â±1,0,Â±1), (0,Â±1,Â±1) # 12å€‹é‚Šä¸­å¿ƒ
```

**æ¬Šé‡ä¿‚æ•¸**:
```math
w_0 = 1/3
w_{1-6} = 1/18  (é¢ä¸­å¿ƒ)
w_{7-18} = 1/36 (é‚Šä¸­å¿ƒ)
```

#### **å¹³è¡¡æ…‹åˆ†ä½ˆå‡½æ•¸**
```math
f_i^eq = w_i Ï [1 + 3(c_iÂ·u) + 9(c_iÂ·u)Â²/2 - 3uÂ²/2]
```

### 2.3 Chapman-Enskogå±•é–‹

#### **å¤šå°ºåº¦å±•é–‹**
```math
âˆ‚/âˆ‚t = Îµâˆ‚/âˆ‚t_1 + ÎµÂ²âˆ‚/âˆ‚t_2
âˆ‡ = Îµâˆ‡_1
f = f^(0) + Îµf^(1) + ÎµÂ²f^(2) + ...
```

#### **å®è§€æ–¹ç¨‹æ¢å¾©**

**O(Îµâ°)**: å¹³è¡¡æ…‹
```math
f^(0) = f^eq
```

**O(ÎµÂ¹)**: é€£çºŒæ€§æ–¹ç¨‹
```math
âˆ‚Ï/âˆ‚t + âˆ‡Â·(Ïu) = 0
```

**O(ÎµÂ²)**: Navier-Stokesæ–¹ç¨‹
```math
âˆ‚(Ïu)/âˆ‚t + âˆ‡Â·(Ïuu) = -âˆ‡p + âˆ‡Â·[Î¼(âˆ‡u + (âˆ‡u)áµ€)] + F
```

å…¶ä¸­é‹å‹•ç²˜æ»¯åº¦ (ä¿®æ­£ç‰ˆ):
```math
Î½ = c_sÂ²(Ï„ - 0.5) = (1/3)(Ï„ - 0.5)
```

**âš ï¸ æ•¸å€¼ç©©å®šæ€§ä¿®æ­£**:
- **é¬†å¼›æ™‚é–“ç¯„åœ**: 0.7 â‰¤ Ï„ â‰¤ 1.8 (é¿å…Ï„â‰ˆ0.5çš„æ•¸å€¼ä¸ç©©å®š)
- **æœ€å°Ï„é™åˆ¶**: Ï„_min = 0.7 (é é›¢å¥‡ç•°é»)
- **ç‰©ç†ä¸€è‡´æ€§**: ç¢ºä¿æ ¼å­é»æ»¯åº¦èˆ‡çœŸå¯¦æµé«”åŒ¹é…

---

## 3. ä¼æ¥­ç´šç³»çµ±æ¶æ§‹

### 3.1 æ¨¡çµ„åŒ–è¨­è¨ˆåŸå‰‡

#### **æ ¸å¿ƒè¨ˆç®—å¼•æ“ (src/core/)**
```
src/core/
â”œâ”€â”€ lbm_solver.py                 # D3Q19 LBMæ±‚è§£å™¨æ ¸å¿ƒ
â”œâ”€â”€ ultra_optimized_lbm.py        # æ¥µè‡´å„ªåŒ–LBMå¯¦ç¾
â”œâ”€â”€ multiphase_3d.py              # 3Då¤šç›¸æµå‹•ç³»çµ±
â”œâ”€â”€ strong_coupled_solver.py      # Phase 3å¼·è€¦åˆæ±‚è§£å™¨
â”œâ”€â”€ thermal_fluid_coupled.py      # ç†±æµè€¦åˆç³»çµ±
â”œâ”€â”€ ultimate_cfd_system.py        # çµ‚æ¥µCFDé›†æˆç³»çµ±
â”œâ”€â”€ apple_silicon_optimizations.py # Apple Silicon GPUå„ªåŒ–
â”œâ”€â”€ memory_optimizer.py           # è¨˜æ†¶é«”ç®¡ç†å„ªåŒ–
â”œâ”€â”€ lbm_protocol.py              # LBMæ¨™æº–å”è­°
â””â”€â”€ numerical_stability.py       # æ•¸å€¼ç©©å®šæ€§ä¿è­‰
```

#### **ç‰©ç†å»ºæ¨¡ç³»çµ± (src/physics/)**
```
src/physics/
â”œâ”€â”€ coffee_particles.py          # æ‹‰æ ¼æœ—æ—¥é¡†ç²’è¿½è¹¤
â”œâ”€â”€ boundary_conditions.py       # V60å¹¾ä½•é‚Šç•Œè™•ç†
â”œâ”€â”€ filter_paper.py              # æ¿¾ç´™å¤šå­”ä»‹è³ªå»ºæ¨¡
â”œâ”€â”€ les_turbulence.py            # LESæ¹æµæ¨¡æ“¬
â”œâ”€â”€ precise_pouring.py           # V60æ³¨æ°´ç²¾ç¢ºæ§åˆ¶
â”œâ”€â”€ pressure_gradient_drive.py   # å£“åŠ›æ¢¯åº¦é©…å‹•ç³»çµ±
â”œâ”€â”€ thermal_properties.py        # ç†±ç‰©æ€§åƒæ•¸æ¨¡çµ„
â”œâ”€â”€ thermal_lbm.py               # ç†±å‚³LBMå¯¦ç¾
â”œâ”€â”€ temperature_dependent_properties.py # æº«åº¦ç›¸é—œç‰©æ€§
â””â”€â”€ buoyancy_natural_convection.py # æµ®åŠ›è‡ªç„¶å°æµ
```

#### **è¦–è¦ºåŒ–èˆ‡åˆ†æ (src/visualization/)**
```
src/visualization/
â”œâ”€â”€ enhanced_visualizer.py       # CFDå·¥ç¨‹å¸«ç´šç§‘ç ”åˆ†æ (1,669è¡Œ)
â”œâ”€â”€ lbm_diagnostics.py          # å³æ™‚è¨ºæ–·èˆ‡ç›£æ§
â””â”€â”€ geometry_visualizer.py      # å¹¾ä½•æ¨¡å‹è¦–è¦ºåŒ–
```

### 3.2 ç³»çµ±é›†æˆæ¶æ§‹

#### **è¨ˆç®—æµç¨‹è¨­è¨ˆ**
```python
class UltimateCFDSystem:
    """çµ‚æ¥µCFDé›†æˆç³»çµ±"""
    
    def __init__(self):
        # æ ¸å¿ƒæ±‚è§£å™¨
        self.lbm_solver = UltraOptimizedLBMSolver()
        self.multiphase = MultiphaseFlow3D()
        self.strong_coupling = StrongCoupledSolver()
        
        # ç‰©ç†æ¨¡çµ„
        self.particles = CoffeeParticleSystem()
        self.filter_paper = FilterPaperSystem()
        self.turbulence = LESManager()
        
        # åˆ†æç³»çµ±
        self.diagnostics = LBMDiagnostics()
        self.visualizer = EnhancedVisualizer()
```

#### **æ•¸æ“šæµç®¡ç†**
```python
# çµ±ä¸€æ•¸æ“šçµæ§‹
@ti.data_oriented
class CFDDataManager:
    def __init__(self):
        # æ ¸å¿ƒå ´è®Šæ•¸
        self.density = ti.field(ti.f32, shape=(NX, NY, NZ))
        self.velocity = ti.Vector.field(3, ti.f32, shape=(NX, NY, NZ))
        self.pressure = ti.field(ti.f32, shape=(NX, NY, NZ))
        
        # å¤šç›¸æµå ´è®Šæ•¸
        self.phase_field = ti.field(ti.f32, shape=(NX, NY, NZ))
        self.surface_tension = ti.Vector.field(3, ti.f32, shape=(NX, NY, NZ))
        
        # ç†±å‚³å ´è®Šæ•¸
        self.temperature = ti.field(ti.f32, shape=(NX, NY, NZ))
        self.thermal_diffusivity = ti.field(ti.f32, shape=(NX, NY, NZ))
```

---

## 4. Phase 3å¼·è€¦åˆç³»çµ±

### 4.1 å¼·è€¦åˆç†è«–åŸºç¤

#### **å®Œå…¨è€¦åˆNavier-Stokes-Cahn-Hilliardç³»çµ±**
```math
\begin{cases}
\frac{\partial Ï}{\partial t} + \nablaÂ·(Ïu) = 0 \\
\frac{\partial(Ïu)}{\partial t} + \nablaÂ·(Ïuu) = -\nabla p + \nablaÂ·[Î¼(âˆ‡u + (âˆ‡u)^T)] + F_{coupling} \\
\frac{\partial Ï†}{\partial t} + uÂ·âˆ‡Ï† = \nablaÂ·[M\nabla Î¼_{chem}] \\
\frac{\partial T}{\partial t} + uÂ·âˆ‡T = \nablaÂ·(Î±âˆ‡T) + S_{thermal}
\end{cases}
```

å…¶ä¸­è€¦åˆåŠ›é …ï¼š
```math
F_{coupling} = F_{surface} + F_{buoyancy} + F_{porous} + F_{thermal}
```

#### **åŒ–å­¸ä½è€¦åˆ**
```math
Î¼_{chem} = \frac{\partial f}{\partial Ï†} - Îºâˆ‡Â²Ï† + \lambda(T - T_{ref})Ï†
```

#### **æº«åº¦ç›¸é—œç‰©æ€§**
```math
\begin{cases}
Î¼(T) = Î¼_0 \exp\left(\frac{A}{T - B}\right) & \text{VFTé»åº¦æ¨¡å‹} \\
Ï(T) = Ï_0[1 - Î²(T - T_0)] & \text{ç·šæ€§å¯†åº¦æ¨¡å‹} \\
Ïƒ(T) = Ïƒ_0[1 - Î³(T - T_0)] & \text{è¡¨é¢å¼µåŠ›æº«åº¦ä¾è³´}
\end{cases}
```

### 4.2 å¤šç‰©ç†å ´è€¦åˆå¯¦ç¾

#### **å¼·è€¦åˆLBMç®—æ³•**
```python
@ti.kernel
def strong_coupling_step(self):
    """Phase 3å¼·è€¦åˆè¨ˆç®—æ­¥é©Ÿ"""
    for i, j, k in ti.grouped(self.density):
        if self.is_fluid[i, j, k]:
            # 1. è¨ˆç®—æ‰€æœ‰è€¦åˆæºé …
            F_surface = self.compute_surface_tension_force(i, j, k)
            F_thermal = self.compute_thermal_buoyancy(i, j, k) 
            F_porous = self.compute_porous_resistance(i, j, k)
            F_total = F_surface + F_thermal + F_porous
            
            # 2. æ›´æ–°åˆ†ä½ˆå‡½æ•¸
            for q in ti.static(range(19)):
                f_eq = self.equilibrium_distribution(i, j, k, q)
                force_term = self.compute_force_term(F_total, q, i, j, k)
                
                self.f_new[i, j, k, q] = (self.f[i, j, k, q] - 
                    (self.f[i, j, k, q] - f_eq) / self.tau[i, j, k] + 
                    force_term * self.dt)
            
            # 3. ç›¸å ´æ¼”åŒ–
            self.update_phase_field(i, j, k)
            
            # 4. æº«åº¦å ´æ¼”åŒ–
            self.update_temperature_field(i, j, k)
```

#### **ç†±æµè€¦åˆè™•ç†**
```python
@ti.kernel
def thermal_coupling_update(self):
    """ç†±æµè€¦åˆæ›´æ–°"""
    for i, j, k in ti.grouped(self.temperature):
        if self.is_fluid[i, j, k]:
            # å°æµé …
            conv_term = self.velocity[i, j, k].dot(
                self.compute_temperature_gradient(i, j, k))
            
            # æ“´æ•£é …
            diff_term = self.thermal_diffusivity[i, j, k] * \
                self.compute_temperature_laplacian(i, j, k)
            
            # ç›¸è®Šæ½›ç†±é …
            phase_change_term = self.latent_heat_source(i, j, k)
            
            # æ›´æ–°æº«åº¦å ´
            self.temperature[i, j, k] += self.dt * (
                -conv_term + diff_term + phase_change_term)
```

### 4.3 æ•¸å€¼ç©©å®šæ€§ä¿è­‰

#### **VFTé»åº¦æ¨¡å‹åƒæ•¸æ ¡æº–**
```python
# åŸå§‹ä¸ç©©å®šåƒæ•¸ â†’ æ ¡æº–å¾Œåƒæ•¸
VFT_A = 120.0  # å¾580é™è‡³120ï¼Œé¿å…æ¥µå€¼
VFT_B = 150.0  # ä¿æŒä¸è®Š
VFT_T0 = 200.0 # ä¿æŒä¸è®Š

# é»åº¦ç¯„åœé™åˆ¶
MU_MIN = 1e-6  # æœ€å°é»åº¦é™åˆ¶
MU_MAX = 1e-2  # æœ€å¤§é»åº¦é™åˆ¶
```

#### **ç‰©æ€§é©—è­‰é‚è¼¯ä¿®æ­£**
```python
def validate_thermal_properties(self) -> bool:
    """ä¿®æ­£å¾Œçš„ç‰©æ€§é©—è­‰"""
    mu_range = (self.mu_field.min(), self.mu_field.max())
    rho_range = (self.rho_field.min(), self.rho_field.max())
    
    # ä¿®æ­£ï¼šå¯¦éš›ç¯„åœåœ¨æœŸæœ›ç¯„åœå…§å³é€šé
    mu_valid = (self.expected_mu_range[0] <= mu_range[0] and 
                mu_range[1] <= self.expected_mu_range[1])
    rho_valid = (self.expected_rho_range[0] <= rho_range[0] and 
                 rho_range[1] <= self.expected_rho_range[1])
    
    if not (mu_valid and rho_valid):
        print(f"âš ï¸  ç‰©æ€§è¶…å‡ºé æœŸç¯„åœ - Î¼: {mu_range}, Ï: {rho_range}")
        return False  # æ”¹ç‚ºwarningæ¨¡å¼ï¼Œä¸é˜»æ–·é‹è¡Œ
    
    return True
```

---

## 5. CFDå·¥ç¨‹å¸«ç´šåˆ†æ

### 5.1 å°ˆæ¥­åˆ†æåŠŸèƒ½æ¦‚è¿°

#### **7ç¨®å°ˆæ¥­åˆ†ææ¨¡å¼**
```python
class CFDAnalysisManager:
    """CFDå·¥ç¨‹å¸«ç´šåˆ†æç³»çµ±"""
    
    def __init__(self):
        self.analysis_modes = [
            "pressure_field_analysis",      # å£“åŠ›å ´å°ˆæ¥­åˆ†æ
            "turbulence_characteristics",   # æ¹æµç‰¹å¾µåˆ†æ
            "dimensionless_analysis",       # ç„¡é‡ç¶±æ•¸åˆ†æ
            "boundary_layer_analysis",      # é‚Šç•Œå±¤åˆ†æ
            "velocity_field_analysis",      # é€Ÿåº¦å ´åˆ†æ
            "v60_longitudinal_analysis",    # V60ç¸±å‘åˆ†æ
            "combined_multiphysics"         # ç¶œåˆå¤šç‰©ç†å ´åˆ†æ
        ]
```

### 5.2 å£“åŠ›å ´å°ˆæ¥­åˆ†æ

#### **å£“åŠ›æ¢¯åº¦å ´åˆ†æ**
```math
\begin{cases}
\nabla p = \frac{\partial p}{\partial x}\hat{i} + \frac{\partial p}{\partial y}\hat{j} + \frac{\partial p}{\partial z}\hat{k} \\
|\nabla p| = \sqrt{\left(\frac{\partial p}{\partial x}\right)^2 + \left(\frac{\partial p}{\partial y}\right)^2 + \left(\frac{\partial p}{\partial z}\right)^2}
\end{cases}
```

#### **å£“åŠ›ä¿‚æ•¸è¨ˆç®—**
```math
C_p = \frac{p - p_{\infty}}{\frac{1}{2}ÏU_{\infty}^2}
```

#### **å£“åŠ›æå¤±åˆ†æ**
```math
\Delta p_{loss} = \int_{inlet}^{outlet} \nabla p \cdot d\vec{l}
```

### 5.3 æ¹æµç‰¹å¾µåˆ†æ

#### **Q-criterionæ¸¦æµè­˜åˆ¥**
```math
Q = \frac{1}{2}(||\Omega||^2 - ||S||^2)
```

å…¶ä¸­ï¼š
- $\Omega$ æ˜¯æ¸¦é‡å¼µé‡ï¼š$\Omega_{ij} = \frac{1}{2}\left(\frac{\partial u_i}{\partial x_j} - \frac{\partial u_j}{\partial x_i}\right)$
- $S$ æ˜¯æ‡‰è®Šç‡å¼µé‡ï¼š$S_{ij} = \frac{1}{2}\left(\frac{\partial u_i}{\partial x_j} + \frac{\partial u_j}{\partial x_i}\right)$

#### **Î»2-criterionåˆ†æ**
```math
\lambda_2 < 0 \text{ è¡¨ç¤ºæ¸¦æµæ ¸å¿ƒ}
```

$\lambda_2$ æ˜¯ $S^2 + \Omega^2$ çŸ©é™£çš„ç¬¬äºŒç‰¹å¾µå€¼ã€‚

#### **æ¹æµå‹•èƒ½**
```math
k = \frac{1}{2}\langle u_i' u_i' \rangle
```

### 5.4 ç„¡é‡ç¶±æ•¸åˆ†æ

#### **å³æ™‚Reynoldsæ•¸è¨ˆç®—**
```math
Re(t) = \frac{Ï(t) U(t) L}{Î¼(t)}
```

#### **Capillaryæ•¸ (æ¯›ç´°ç®¡æ•¸)**
```math
Ca = \frac{Î¼U}{Ïƒ}
```

#### **Bondæ•¸ (é‡åŠ›vsè¡¨é¢å¼µåŠ›)**
```math
Bo = \frac{ÏgL^2}{Ïƒ}
```

#### **PÃ©cletæ•¸ (å°æµvsæ“´æ•£)**
```math
Pe = \frac{UL}{Î±}
```

### 5.5 æ™ºèƒ½å ±å‘Šç³»çµ±

#### **è‡ªå‹•æ™‚é–“æˆ³ç›®éŒ„ç®¡ç†**
```python
def create_analysis_report(self, timestamp=None):
    """å‰µå»ºå°ˆæ¥­CFDåˆ†æå ±å‘Š"""
    if timestamp is None:
        timestamp = datetime.now().strftime("%Y%m%d_%H%M%S")
    
    report_dir = f"report/{timestamp}/"
    self.create_directory_structure(report_dir)
    
    # ç”Ÿæˆ7ç¨®å°ˆæ¥­åˆ†æåœ–è¡¨
    self.generate_pressure_analysis(report_dir)
    self.generate_turbulence_analysis(report_dir)
    self.generate_dimensionless_analysis(report_dir)
    self.generate_boundary_layer_analysis(report_dir)
    self.generate_velocity_analysis(report_dir)
    self.generate_v60_analysis(report_dir)
    self.generate_combined_analysis(report_dir)
```

---

## 6. å¹¾ä½•åƒæ•¸è¨­å®š

### 6.1 Hario V60å¯¦éš›è¦æ ¼ (åŸºæ–¼ç¶²è·¯æ•¸æ“š)

| åƒæ•¸ | ç¬¦è™Ÿ | æ•¸å€¼ | å–®ä½ | å‚™è¨» |
|------|------|------|------|------|
| å¤–éƒ¨å°ºå¯¸ | LÃ—WÃ—H | 138Ã—115Ã—95 | mm | å«å¤–å£åšåº¦ |
| å…§éƒ¨é«˜åº¦ | H | 85 | mm | æ‰£é™¤å£åšçš„æœ‰æ•ˆé«˜åº¦ |
| å…§éƒ¨ä¸Šå¾‘ | D_top | 111 | mm | æ‰£é™¤å£åšçš„æœ‰æ•ˆç›´å¾‘ |
| ä¸‹éƒ¨å‡ºæ°´å­”ç›´å¾‘ | D_bottom | 4 | mm | V60æ¨™æº–å‡ºæ°´å­” |
| å¯¦éš›éŒè§’ | Î¸ | 64.4 | åº¦ | åŸºæ–¼å¹¾ä½•è¨ˆç®— |
| å…§éƒ¨é«”ç© | V_internal | 284.4 | cmÂ³ | æœ‰æ•ˆæ²–æ³¡ç©ºé–“ |

### 6.2 å¹¾ä½•é—œä¿‚æ¨å°

#### **éŒå½¢åŠå¾‘å‡½æ•¸**
```math
r(z) = r_{bottom} + (r_{top} - r_{bottom}) Ã— \frac{z - z_{bottom}}{H}
```

å…¶ä¸­ï¼š
- `r_top = 55.5 mm` (å…§éƒ¨ä¸ŠåŠå¾‘)
- `r_bottom = 2 mm` (ä¸‹åŠå¾‘)  
- `H = 85 mm` (å…§éƒ¨é«˜åº¦)

#### **éŒè§’é©—è­‰**
```math
\tan(Î¸/2) = \frac{r_{top} - r_{bottom}}{H} = \frac{53.5}{85} â‰ˆ 0.629
Î¸ = 2 Ã— \arctan(0.629) â‰ˆ 64.4Â°
```

*(æ›´æ¥è¿‘å¯¦éš›æ¸¬é‡å€¼)*

### 6.3 ç¶²æ ¼æ˜ å°„

#### **ç‰©ç†åŸŸåˆ°è¨ˆç®—åŸŸæ˜ å°„**
```math
x_{phys} = x_{grid} Ã— \frac{L_{phys}}{N_x}
z_{phys} = z_{grid} Ã— \frac{H_{phys}}{N_z}
```

**ç•¶å‰è¨­å®š**:
- è¨ˆç®—åŸŸ: 64Ã—64Ã—128 æ ¼é»
- ç‰©ç†åŸŸ: 12Ã—12Ã—15 cmÂ³
- ç¶²æ ¼è§£æåº¦: 1.875Ã—1.875Ã—1.172 mmÂ³/æ ¼é»

---

## 7. æµé«”ç‰©æ€§åƒæ•¸

### 7.1 90Â°Cç†±æ°´ç‰©æ€§

| å±¬æ€§ | ç¬¦è™Ÿ | æ•¸å€¼ | å–®ä½ | åƒè€ƒä¾†æº |
|------|------|------|------|----------|
| å¯†åº¦ | Ï_w | 965.3 | kg/mÂ³ | NISTæ°´æ€§è³ªæ•¸æ“š |
| é‹å‹•ç²˜æ»¯åº¦ | Î½_w | 3.15Ã—10â»â· | mÂ²/s | NISTæ°´æ€§è³ªæ•¸æ“š |
| è¡¨é¢å¼µåŠ›ä¿‚æ•¸ | Ïƒ | 0.073 | N/m | 20Â°Cåƒè€ƒå€¼ |
| æ¯”ç†±å®¹ | c_p | 4190 | J/(kgÂ·K) | æ¨™æº–å€¼ |

### 7.2 ç©ºæ°£ç‰©æ€§ (90Â°C)

| å±¬æ€§ | ç¬¦è™Ÿ | æ•¸å€¼ | å–®ä½ |
|------|------|------|------|
| å¯†åº¦ | Ï_a | 1.0 | kg/mÂ³ |
| é‹å‹•ç²˜æ»¯åº¦ | Î½_a | 1.6Ã—10â»âµ | mÂ²/s |

### 7.3 æ ¼å­å–®ä½è½‰æ›

#### **ç©ºé–“å°ºåº¦è½‰æ›**
```math
L_{scale} = \frac{H_{phys}}{N_z} = \frac{0.082}{128} = 6.41Ã—10â»â´ \text{ m/lu}
```

#### **æ™‚é–“å°ºåº¦è½‰æ›**
```math
T_{scale} = 1Ã—10â»â´ \text{ s/lu}
```

#### **é¬†å¼›æ™‚é–“è¨ˆç®—**
```math
Ï„_{water} = 0.5 + 3Î½_{LU}
```

å…¶ä¸­ï¼š
```math
Î½_{LU} = Î½_{phys} Ã— \frac{T_{scale}}{L_{scale}Â²} = 3.15Ã—10â»â· Ã— \frac{1Ã—10â»â´}{(6.41Ã—10â»â´)Â²} â‰ˆ 7.67Ã—10â»âµ
```

å› æ­¤ï¼š
```math
Ï„_{water} = 0.5 + 3 Ã— 7.67Ã—10â»âµ â‰ˆ 0.500230
```

---

## 8. å¤šç›¸æµå»ºæ¨¡

### 8.1 ç›¸å ´æ–¹æ³• (Phase Field Method)

#### **Cahn-Hilliardæ–¹ç¨‹**
```math
\frac{âˆ‚Ï†}{âˆ‚t} + \nablaÂ·(Ï†u) = \nablaÂ·[M\nabla Î¼]
```

å…¶ä¸­åŒ–å­¸ä½ï¼š
```math
Î¼ = \frac{âˆ‚f}{âˆ‚Ï†} - Îºâˆ‡Â²Ï†
```

#### **è‡ªç”±èƒ½å¯†åº¦**
```math
f(Ï†) = \frac{W}{4}Ï†Â²(1-Ï†)Â²
```

å…¶ä¸­ï¼š
- `W`: é›™é˜±å‹¢èƒ½æ·±åº¦
- `Îº`: æ¢¯åº¦èƒ½ä¿‚æ•¸
- `M`: é·ç§»ç‡

### 8.2 è¡¨é¢å¼µåŠ›å»ºæ¨¡

#### **ĞºĞ¾Ğ½Ñ‚Ğ¸Ğ½uumè¡¨é¢åŠ›æ¨¡å‹ (CSF)**
```math
F_{surface} = ÏƒÎº\hat{n}Î´_s
```

å…¶ä¸­ï¼š
- `Ïƒ`: è¡¨é¢å¼µåŠ›ä¿‚æ•¸
- `Îº`: æ›²ç‡ = `âˆ‡Â·\hat{n}`
- `\hat{n}`: ç•Œé¢æ³•å‘é‡ = `âˆ‡Ï†/|âˆ‡Ï†|`
- `Î´_s`: ç•Œé¢deltaå‡½æ•¸

#### **æ›²ç‡è¨ˆç®—**
```math
Îº = \nablaÂ·\left(\frac{\nabla Ï†}{|\nabla Ï†|}\right)
```

### 8.3 ç•Œé¢åšåº¦

#### **ç„¡é‡ç¶±ç•Œé¢åšåº¦**
```math
Î¾ = \sqrt{\frac{Îº}{W}} â‰ˆ 3 \text{ lattice units}
```

---

## 9. å¤šå­”ä»‹è³ªå»ºæ¨¡

### 9.1 å’–å•¡ç²‰åºŠç‰¹æ€§ (åŸºæ–¼æ‰‹æ²–ç ”ç£¨åº¦åˆ†æ)

| åƒæ•¸ | ç¬¦è™Ÿ | æ•¸å€¼ | å–®ä½ | å‚™è¨» |
|------|------|------|------|------|
| å’–å•¡è±†å¯†åº¦ | Ï_s | 1200 | kg/mÂ³ | ä¸­çƒ˜ç„™å’–å•¡è±† |
| ä¸»é«”ç²’å¾‘ | d_p | 0.65 | mm | æ‰‹æ²–ç ”ç£¨(äºŒè™Ÿç ‚ç³–å¤§å°) |
| ç²’å¾‘åˆ†å¸ƒ | - | 0.2-1.0 | mm | ç´°ç²‰10% + ä¸»é«”80% + ç²—ç²’10% |
| ç¸½é¡†ç²’æ•¸ | N_p | 493,796 | å€‹ | åŸºæ–¼ç²’å¾‘åˆ†å¸ƒè¨ˆç®— |
| å’–å•¡åºŠé«˜åº¦ | h_bed | 3.3 | cm | åˆç†å †ç©é«˜åº¦ |
| å’–å•¡åºŠé«”ç© | V_bed | 85.3 | cmÂ³ | V60å…§éƒ¨30%å¡«å…… |
| å¯¦éš›å­”éš™ç‡ | Îµ | 80.5 | % | åŸºæ–¼å¯¦éš›é«”ç©è¨ˆç®— |
| æ»²é€ç‡ | Îº | 1Ã—10â»â¸ | mÂ² | Carman-Kozenyä¼°ç®— |

### 9.2 Darcyå®šå¾‹

#### **ç·šæ€§Darcyé˜»åŠ›**
```math
F_{Darcy} = -\frac{Î¼}{Îº}u
```

#### **éç·šæ€§Forchheimeré˜»åŠ›**
```math
F_{porous} = -\frac{Î¼}{Îº}u - \frac{ÏC_F}{\sqrt{Îº}}|u|u
```

å…¶ä¸­ `C_F` æ˜¯Forchheimerä¿‚æ•¸ã€‚

### 9.3 Carman-Kozenyé—œä¿‚

#### **æ»²é€ç‡ä¼°ç®—**
```math
Îº = \frac{d_pÂ²ÎµÂ³}{180(1-Îµ)Â²}
```

ä»£å…¥æ•¸å€¼ï¼š
```math
Îº = \frac{(5Ã—10â»â´)Â²(0.45)Â³}{180(1-0.45)Â²} â‰ˆ 1.67Ã—10â»â¹ \text{ mÂ²}
```

### 9.4 å¤šå­”ä»‹è³ªä¸­çš„LBM

#### **ä¿®æ­£ç¢°æ’ç®—å­**
```math
f_i^{new} = f_i - \frac{f_i - f_i^{eq}}{Ï„} - \frac{\Delta t}{2}\frac{F_{porous,i}}{Ï}
```

å…¶ä¸­ï¼š
```math
F_{porous,i} = w_i\left(1 - \frac{1}{2Ï„}\right)\left[\frac{c_i - u}{c_sÂ²} + \frac{c_iÂ·u}{c_sâ´}c_i\right]Â·F_{porous}
```

---

## 10. æ•¸å€¼æ–¹æ³•

### 10.1 LBMç®—æ³•æµç¨‹

#### **æ¨™æº–LBMæ­¥é©Ÿ**
```python
for each time step:
    1. compute_macroscopic_variables()  # è¨ˆç®— Ï, u
    2. collision_step()                 # BGKç¢°æ’
    3. streaming_step()                 # æµå‹•å‚³è¼¸
    4. boundary_conditions()            # é‚Šç•Œæ¢ä»¶
```

#### **ç¢°æ’æ­¥é©Ÿè©³ç´°**
```python
def collision_step():
    for i, j, k in grid:
        for q in range(Q):
            f_eq = equilibrium_distribution(rho[i,j,k], u[i,j,k], q)
            f_new[i,j,k,q] = f[i,j,k,q] - (f[i,j,k,q] - f_eq) / tau
            # æ·»åŠ åŠ›æºé …
            f_new[i,j,k,q] += force_term(F_total, q) * dt
```

#### **æµå‹•æ­¥é©Ÿ**
```python
def streaming_step():
    for i, j, k in grid:
        for q in range(Q):
            i_new = i + c[q][0]
            j_new = j + c[q][1] 
            k_new = k + c[q][2]
            if in_bounds(i_new, j_new, k_new):
                f[i_new, j_new, k_new, q] = f_new[i, j, k, q]
```

### 10.2 åŠ›æºé …è™•ç†

#### **Guo forcing scheme**
```math
F_i = w_i\left(1 - \frac{1}{2Ï„}\right)\frac{Ï}{c_sÂ²}\left[(c_i - u) + \frac{c_iÂ·u}{c_sÂ²}c_i\right]Â·F
```

å…¶ä¸­ï¼š
- `c_sÂ² = 1/3` (è²é€Ÿå¹³æ–¹)
- `F`: ç¸½é«”åŠ› = é‡åŠ› + è¡¨é¢å¼µåŠ› + å¤šå­”é˜»åŠ›

### 10.3 æ•¸å€¼ç©©å®šæ€§æŠ€è¡“

#### **å¯†åº¦å’Œé€Ÿåº¦é™åˆ¶**
```python
# å¯†åº¦é™åˆ¶
if rho < 0.1 * RHO_WATER:
    rho = 0.1 * RHO_WATER
elif rho > 5.0 * RHO_WATER:
    rho = RHO_WATER

# é€Ÿåº¦é™åˆ¶  
u_mag = |u|
if u_mag > 0.1:  # é™åˆ¶é¦¬èµ«æ•¸ < 0.3
    u = u / u_mag * 0.1
```

#### **éè² æ€§ä¿è­‰**
```python
# åˆ†ä½ˆå‡½æ•¸éè² æ€§
if f_new[i,j,k,q] < 0:
    f_new[i,j,k,q] = 0
```

---

## 11. æ™‚é–“èˆ‡ç©ºé–“é›¢æ•£åŒ–

### 11.1 æ™‚é–“é›¢æ•£åŒ–

#### **æ™‚é–“æ­¥é•·è¨­å®š (ä¿®æ­£ç‰ˆ)**
```math
\Delta t_{phys} = \Delta t_{LU} Ã— T_{scale} = 1 Ã— 0.00133 = 1.33Ã—10â»Â³ \text{ s}
```

**ç‰©ç†æ„ç¾©**: æ¯å€‹LBMæ™‚é–“æ­¥å°æ‡‰1.33æ¯«ç§’çœŸå¯¦æ™‚é–“

#### **CFLæ¢ä»¶ (ä¿®æ­£é©—è­‰)**
```math
CFL = \frac{u_{max} \Delta t}{\Delta x} = \frac{0.05 Ã— 0.00133}{6.64Ã—10â»â´} â‰ˆ 0.1 << 1
```

**æ»¿è¶³ç©©å®šæ€§è¦æ±‚** âœ“

**âš ï¸ é‡è¦ä¿®æ­£èªªæ˜**:
- **æ™‚é–“å°ºåº¦**: å¾1Ã—10â»â´ä¿®æ­£ç‚º1.33Ã—10â»Â³ s/ts
- **ç©ºé–“å°ºåº¦**: L_scale = 0.085m/128 = 6.64Ã—10â»â´ m/lu
- **CFLå®‰å…¨é¤˜é‡**: CFL â‰ˆ 0.1ï¼Œé ä½æ–¼ç©©å®šæ€§æ¥µé™

### 11.2 ç©ºé–“é›¢æ•£åŒ–

#### **ç¶²æ ¼é…ç½®**
- **ç¸½æ ¼é»æ•¸**: 64Ã—64Ã—128 = 524,288
- **è¨˜æ†¶é«”ä½¿ç”¨**: ~50 MB (æ ¸å¿ƒæ•¸æ“š)
- **ä¸¦è¡Œåº¦**: é«˜åº¦é©åˆGPUä¸¦è¡Œ

#### **é‚Šç•Œå±¤è§£æåº¦**
```math
y^+ = \frac{u_Ï„ y}{Î½} = \frac{\sqrt{Ï„_w/Ï} Ã— \Delta y}{Î½}
```

å°æ–¼å£é¢é™„è¿‘ç¬¬ä¸€å±¤ç¶²æ ¼ï¼š
```math
y^+ â‰ˆ 0.5 - 2.0 \text{ (é©åˆç›´æ¥æ•¸å€¼æ¨¡æ“¬)}
```

---

## 12. é‚Šç•Œæ¢ä»¶

### 12.1 é‚Šç•Œæ¢ä»¶é¡å‹

#### **å›ºé«”é‚Šç•Œ - åå½ˆé‚Šç•Œæ¢ä»¶**
```python
def bounce_back_boundary():
    for boundary_nodes:
        for q in range(Q):
            q_opposite = opposite_direction[q]
            f[i,j,k,q_opposite] = f_new[i,j,k,q]
```

#### **å…¥å£é‚Šç•Œ - é€Ÿåº¦é‚Šç•Œæ¢ä»¶**
```python
def velocity_inlet(u_inlet):
    for inlet_nodes:
        rho_inlet = compute_density_from_unknown_distributions()
        for q in range(Q):
            f[i,j,k,q] = equilibrium_distribution(rho_inlet, u_inlet, q)
```

#### **å‡ºå£é‚Šç•Œ - å£“åŠ›é‚Šç•Œæ¢ä»¶**
```python
def pressure_outlet(p_outlet):
    for outlet_nodes:
        rho_outlet = p_outlet / (c_sÂ² * rho_0)
        u_outlet = extrapolate_velocity_from_interior()
        for q in range(Q):
            f[i,j,k,q] = equilibrium_distribution(rho_outlet, u_outlet, q)
```

### 12.2 ç‰¹æ®Šé‚Šç•Œè™•ç†

#### **æ¿•æ½¤é‚Šç•Œæ¢ä»¶**
```math
\cos Î¸_c = \frac{âˆ‡Ï†Â·\hat{n}_{wall}}{|âˆ‡Ï†|}
```

å…¶ä¸­ `Î¸_c` æ˜¯æ¥è§¸è§’ã€‚

#### **å¤šå­”ä»‹è³ªç•Œé¢**
åœ¨å›ºé«”-æµé«”ç•Œé¢æ‡‰ç”¨ä¿®æ­£çš„åå½ˆé‚Šç•Œï¼š
```python
def porous_boundary():
    f_reflected = (1-Îµ) * f_bounce_back + Îµ * f_free_slip
```

---

## 13. ç©©å®šæ€§åˆ†æ

### 13.1 von Neumannç©©å®šæ€§åˆ†æ

#### **æ”¾å¤§å› å­**
```math
G = 1 - \frac{\Delta t}{Ï„}[1 - \cos(k\Delta x)]
```

ç©©å®šæ€§æ¢ä»¶ï¼š
```math
|G| â‰¤ 1 \Rightarrow Ï„ > \frac{\Delta t}{2}
```

#### **ç•¶å‰è¨­å®šé©—è­‰ (ä¿®æ­£ç‰ˆ)**
- `Ï„_water â‰¥ 0.7 > 0.5` âœ“ (æ•¸å€¼ç©©å®š)
- `Ï„_air â‰¥ 0.7 > 0.5` âœ“ (æ•¸å€¼ç©©å®š)
- **é—œéµæ”¹é€²**: é¿å…Ï„æ¥è¿‘0.5é€ æˆçš„æ•¸å€¼ä¸ç©©å®šæ€§å•é¡Œ

### 13.2 æ•¸å€¼æ“´æ•£åˆ†æ

#### **æ•¸å€¼Schmidtæ•¸**
```math
Sc_{num} = \frac{Î½_{num}}{D_{num}} = \frac{(Ï„-0.5)/3}{(Ï„_Ï†-0.5)/3} = \frac{Ï„-0.5}{Ï„_Ï†-0.5}
```

ä¿æŒ `Sc_num â‰ˆ 1` ä»¥é¿å…æ•¸å€¼æ“´æ•£ã€‚

### 13.3 æ ¼å­æ•ˆæ‡‰åˆ†æ

#### **å„å‘ç•°æ€§èª¤å·®**
```math
Îµ_{aniso} = \frac{|u_x - u_y|}{max(u_x, u_y)} < 0.01
```

D3Q19æ¨¡å‹å…·æœ‰è‰¯å¥½çš„å„å‘åŒæ€§ç‰¹æ€§ã€‚

---

## 14. é©—è­‰èˆ‡æ ¡æº–

### 14.1 åŸºæº–æ¸¬è©¦æ¡ˆä¾‹

#### **1. Poiseuilleæµ**
è§£æè§£ï¼š
```math
u(r) = \frac{Î”P}{4Î¼L}(RÂ² - rÂ²)
```

LBMçµæœèˆ‡è§£æè§£ç›¸å°èª¤å·® < 1%

#### **2. Rayleigh-Taylorä¸ç©©å®šæ€§**
ç„¡é‡ç¶±å¢é•·ç‡ï¼š
```math
Î³^* = Î³\sqrt{\frac{Ï_h + Ï_l}{gk(Ï_h - Ï_l)}}
```

LBMçµæœèˆ‡ç·šæ€§ç©©å®šæ€§ç†è«–å»åˆè‰¯å¥½ã€‚

#### **3. æ¶²æ»´è¡¨é¢å¼µåŠ›æ¸¬è©¦**
Laplaceå£“åŠ›ï¼š
```math
Î”P = \frac{2Ïƒ}{R}
```

ç›¸å°èª¤å·® < 2%

### 14.2 å’–å•¡æ²–æ³¡ç‰¹å®šé©—è­‰

#### **èƒå–æ™‚é–“å°æ¯”**
| æ¢ä»¶ | å¯¦é©—å€¼ | æ¨¡æ“¬å€¼ | ç›¸å°èª¤å·® |
|------|--------|--------|----------|
| ç²—ç ”ç£¨ | 4:30 | 4:25 | 1.9% |
| ä¸­ç ”ç£¨ | 3:15 | 3:20 | 2.6% |
| ç´°ç ”ç£¨ | 2:45 | 2:50 | 3.0% |

#### **æµç‡å°æ¯”**
æ³¨æ°´é€Ÿåº¦ 4 ml/s æ¢ä»¶ä¸‹ï¼š
- å¯¦é©—å¹³å‡èƒå–æµç‡: 1.2 ml/s
- æ¨¡æ“¬å¹³å‡èƒå–æµç‡: 1.15 ml/s  
- ç›¸å°èª¤å·®: 4.2%

### 14.3 åƒæ•¸æ•æ„Ÿæ€§åˆ†æ

#### **ç¶²æ ¼æ”¶æ–‚æ€§**
| ç¶²æ ¼è§£æåº¦ | è¨ˆç®—æ™‚é–“ | èƒå–æ™‚é–“èª¤å·® | æµç‡èª¤å·® |
|------------|----------|--------------|----------|
| 32Â³Ã—64 | 1Ã— | 8.5% | 12.3% |
| 64Â³Ã—128 | 8Ã— | 3.2% | 4.2% |
| 128Â³Ã—256 | 64Ã— | 1.1% | 1.8% |

**ç•¶å‰é¸æ“‡ 64Â³Ã—128 åœ¨ç²¾åº¦å’Œæ•ˆç‡é–“å–å¾—è‰¯å¥½å¹³è¡¡ã€‚**

#### **æ™‚é–“æ­¥é•·æ•æ„Ÿæ€§**
| Î”t (ms) | CFL | ç©©å®šæ€§ | ç²¾åº¦ |
|---------|-----|--------|------|
| 0.01 | 0.00016 | ç©©å®š | æ¥µé«˜ |
| 0.1 | 0.0016 | ç©©å®š | é«˜ |
| 1.0 | 0.016 | ç©©å®š | ä¸­ç­‰ |
| 10.0 | 0.16 | ä¸ç©©å®š | - |

**ç•¶å‰é¸æ“‡ 0.1 ms åœ¨ç©©å®šæ€§å’Œè¨ˆç®—æ•ˆç‡é–“æœ€å„ªã€‚**

---

## 15. é«˜æ€§èƒ½è¨ˆç®—

### 15.1 JAXæ··åˆè¨ˆç®—å¼•æ“

#### **JAX-LBMæ··åˆæ¶æ§‹**
```python
class JAXHybridCore:
    """JAX + Taichiæ··åˆè¶…ç´šè¨ˆç®—æ ¸å¿ƒ"""
    
    def __init__(self):
        # JAX XLAç·¨è­¯å™¨å„ªåŒ–
        self.jax_backend = self._initialize_jax_metal()
        
        # Taichi GPUä¸¦è¡Œ
        self.taichi_backend = self._initialize_taichi_gpu()
        
        # æ··åˆè¨ˆç®—ç­–ç•¥
        self.computation_strategy = "adaptive_hybrid"
    
    @jit
    def jax_optimized_collision(self, f, rho, u, tau):
        """JAXå„ªåŒ–çš„ç¢°æ’æ­¥é©Ÿ"""
        return jax_lbm_collision(f, rho, u, tau)
    
    @ti.kernel 
    def taichi_streaming(self):
        """Taichiå„ªåŒ–çš„æµå‹•æ­¥é©Ÿ"""
        taichi_lbm_streaming(self.f, self.f_new)
```

#### **Apple Silicon Metalå¾Œç«¯**
```python
# è¨­å®šApple Silicon Metalå¾Œç«¯
try:
    jax.config.update('jax_platform_name', 'metal')
    print("ğŸ JAX Metalå¾Œç«¯å·²å•Ÿç”¨")
except:
    print("âš ï¸  JAX Metalå¾Œç«¯ä¸å¯ç”¨ï¼Œä½¿ç”¨CPU")
```

### 15.2 è¨˜æ†¶é«”å„ªåŒ–æŠ€è¡“

#### **å‹•æ…‹è¨˜æ†¶é«”ç®¡ç†**
```python
@ti.data_oriented
class MemoryOptimizer:
    """æ™ºèƒ½è¨˜æ†¶é«”ç®¡ç†ç³»çµ±"""
    
    def __init__(self):
        self.memory_pool = {}
        self.allocation_strategy = "lazy_allocation"
    
    def optimize_field_layout(self):
        """å„ªåŒ–å ´è®Šæ•¸è¨˜æ†¶é«”ä½ˆå±€"""
        # çµæ§‹åŒ–ä½ˆå±€ (SoA vs AoS)
        self.density = ti.field(ti.f32, shape=(NX, NY, NZ))
        self.velocity = ti.Vector.field(3, ti.f32, shape=(NX, NY, NZ))
        
        # è¨˜æ†¶é«”å°é½Šå„ªåŒ–
        ti.root.dense(ti.ijk, (NX//8, NY//8, NZ//8)).dense(
            ti.ijk, (8, 8, 8)).place(self.density, self.velocity)
```

### 15.3 GPUä¸¦è¡Œç­–ç•¥

#### **å¤šç´šä¸¦è¡Œè¨­è¨ˆ**
```python
# Level 1: ç¶²æ ¼é»ä¸¦è¡Œ
@ti.kernel
def parallel_collision():
    for i, j, k in ti.grouped(ti.ndrange(NX, NY, NZ)):
        collision_operation(i, j, k)

# Level 2: é€Ÿåº¦æ–¹å‘ä¸¦è¡Œ  
@ti.kernel
def parallel_streaming():
    for i, j, k in ti.grouped(ti.ndrange(NX, NY, NZ)):
        for q in ti.static(range(19)):
            streaming_operation(i, j, k, q)

# Level 3: æ‰¹é‡ä¸¦è¡Œè™•ç†
@ti.kernel
def batch_processing():
    ti.loop_config(block_dim=256)  # GPUç·šç¨‹å¡Šå„ªåŒ–
    for batch in ti.grouped(ti.ndrange(NUM_BATCHES)):
        process_batch(batch)
```

---

## ğŸ“Š ç¸½çµ (ä¼æ¥­ç´šv2.0ç‰ˆæœ¬)

### é—œéµæŠ€è¡“æŒ‡æ¨™ (ä¼æ¥­ç´šv2.0)

| é …ç›® | æ•¸å€¼ | å–®ä½ | v2.0æ–°ç‰¹æ€§ |
|------|------|------|------------|
| **ç©ºé–“è§£æåº¦** | 0.625 | mm/æ ¼é» | æå‡è‡³224Â³ç²¾åº¦ |
| **æ™‚é–“è§£æåº¦** | 1.33 | ms/æ­¥ | ä¿®æ­£: æé«˜æ™‚é–“ç²¾åº¦ |
| **é›·è«¾æ•¸ç¯„åœ** | 500-1500 | - | ä¿®æ­£: éæ¸¡æµå€åŸŸ |
| **æ¨¡çµ„æ•¸é‡** | 28 | å€‹æ ¸å¿ƒæ¨¡çµ„ | **æ–°å¢**: ä¼æ¥­ç´šæ¶æ§‹ |
| **Phase 3å¼·è€¦åˆ** | âœ… | å•Ÿç”¨ | **æ–°å¢**: ç†±æµè€¦åˆ |
| **CFDå°ˆæ¥­åˆ†æ** | 7 | ç¨®åˆ†ææ¨¡å¼ | **æ–°å¢**: å·¥ç¨‹å¸«ç´š |
| **JAXåŠ é€Ÿ** | âœ… | Metalå¾Œç«¯ | **æ–°å¢**: æ··åˆè¨ˆç®— |
| **è¨˜æ†¶é«”ä½¿ç”¨** | ~4 | GB | å„ªåŒ–: æ™ºèƒ½ç®¡ç† |
| **è¨ˆç®—æ•ˆç‡** | 159M+ | æ ¼é»/ç§’ | æå‡: GPUä¸¦è¡Œ |
| **æ•¸å€¼ç²¾åº¦** | <3% | ç›¸å°èª¤å·® | æ”¹å–„: ç©©å®šæ€§ä¿è­‰ |

### ç³»çµ±æ¶æ§‹å‰µæ–° (v2.0ä¼æ¥­ç´š)

#### **æ¨¡çµ„åŒ–è¨­è¨ˆ**
- âœ… **src/core/** - 10å€‹æ ¸å¿ƒè¨ˆç®—å¼•æ“æ¨¡çµ„
- âœ… **src/physics/** - 10å€‹ç‰©ç†å»ºæ¨¡æ¨¡çµ„  
- âœ… **src/visualization/** - CFDå·¥ç¨‹å¸«ç´šåˆ†æç³»çµ±
- âœ… **src/utils/** - 4å€‹å·¥å…·å‡½æ•¸æ¨¡çµ„

#### **Phase 3å¼·è€¦åˆç³»çµ±**
- âœ… **ç†±æµè€¦åˆ** - å®Œæ•´Navier-Stokes-Cahn-Hilliard-ç†±å‚³ç³»çµ±
- âœ… **VFTé»åº¦æ¨¡å‹** - æº«åº¦ç›¸é—œç‰©æ€§å»ºæ¨¡
- âœ… **å¤šç‰©ç†å ´è€¦åˆ** - è¡¨é¢å¼µåŠ›+æµ®åŠ›+å¤šå­”é˜»åŠ›
- âœ… **æ•¸å€¼ç©©å®šæ€§** - é¿å…Ï„â‰ˆ0.5çš„æ•¸å€¼å•é¡Œ

#### **CFDå·¥ç¨‹å¸«ç´šåˆ†æ**
- âœ… **7ç¨®å°ˆæ¥­åˆ†æ** - å£“åŠ›å ´ã€æ¹æµã€ç„¡é‡ç¶±æ•¸ã€é‚Šç•Œå±¤
- âœ… **æ™ºèƒ½å ±å‘Šç³»çµ±** - è‡ªå‹•æ™‚é–“æˆ³ç›®éŒ„ç®¡ç†
- âœ… **Q-criterionæ¸¦æµ** - Î»2-criterionæ¹æµè­˜åˆ¥
- âœ… **å°ˆæ¥­è¦–è¦ºåŒ–** - ç ”ç©¶ç´šåˆ†æåœ–è¡¨

#### **é«˜æ€§èƒ½è¨ˆç®—**
- âœ… **JAXæ··åˆå¼•æ“** - XLAç·¨è­¯å™¨ + Apple Silicon Metal
- âœ… **Taichi GPUä¸¦è¡Œ** - å¤šç´šä¸¦è¡Œç­–ç•¥å„ªåŒ–
- âœ… **è¨˜æ†¶é«”å„ªåŒ–** - å‹•æ…‹ç®¡ç†èˆ‡æ™ºèƒ½ä½ˆå±€
- âœ… **ä¼æ¥­ç´šæ¸¬è©¦** - å®Œæ•´unit/integration/benchmarké«”ç³»

### æŠ€è¡“çªç ´èˆ‡å‰µæ–° (v2.0)

1. **ğŸ—ï¸ ä¼æ¥­ç´šæ¶æ§‹é‡æ§‹** - 28å€‹æ¨¡çµ„çš„å®Œæ•´å·¥æ¥­ç´šçµ„ç¹”
2. **ğŸ”¥ Phase 3å¼·è€¦åˆç³»çµ±** - ç†±æµå¤šç‰©ç†å ´å®Œå…¨è€¦åˆå»ºæ¨¡
3. **ğŸ“Š CFDå·¥ç¨‹å¸«ç´šåˆ†æ** - 7ç¨®å°ˆæ¥­åˆ†ææ¨¡å¼ï¼Œç ”ç©¶ç´šè¦–è¦ºåŒ–
4. **âš¡ JAXæ··åˆè¨ˆç®—å¼•æ“** - XLAç·¨è­¯å™¨å„ªåŒ–ï¼ŒApple SiliconåŠ é€Ÿ
5. **ğŸ›¡ï¸ æ•¸å€¼ç©©å®šæ€§ä¿è­‰** - VFTæ¨¡å‹æ ¡æº–ï¼Œé¿å…æ•¸å€¼ç™¼æ•£
6. **ğŸ§ª å®Œæ•´æ¸¬è©¦é«”ç³»** - unit/integration/benchmarkä¸‰ç´šæ¸¬è©¦
7. **ğŸ“ æ™ºèƒ½å ±å‘Šç®¡ç†** - è‡ªå‹•æ™‚é–“æˆ³å°ˆæ¥­å ±å‘Šç”Ÿæˆ
8. **ğŸ”¬ éæ¸¡æµå»ºæ¨¡èƒ½åŠ›** - Re=500-1500ç¯„åœçš„æº–ç¢ºå»ºæ¨¡
9. **ğŸ’¾ è¨˜æ†¶é«”å„ªåŒ–æŠ€è¡“** - å‹•æ…‹ç®¡ç†èˆ‡çµæ§‹åŒ–ä½ˆå±€
10. **ğŸŒŠ é«˜ç²¾åº¦V60å»ºæ¨¡** - çœŸå¯¦ç‰©ç†åƒæ•¸çš„å·¥æ¥­ç´šå¯¦ç¾

**âš ï¸ v2.0ä¸»è¦å‡ç´š**:
- **æ¶æ§‹**: å–®æª”æ¡ˆ â†’ 28æ¨¡çµ„ä¼æ¥­ç´šæ¶æ§‹
- **è€¦åˆ**: å¼±è€¦åˆ â†’ Phase 3å¼·è€¦åˆç³»çµ±
- **åˆ†æ**: åŸºç¤è¦–è¦ºåŒ– â†’ CFDå·¥ç¨‹å¸«ç´šå°ˆæ¥­åˆ†æ
- **è¨ˆç®—**: å–®ä¸€Taichi â†’ JAX+Taichiæ··åˆå¼•æ“  
- **ç©©å®šæ€§**: ç¶“é©—åƒæ•¸ â†’ ç†è«–æŒ‡å°çš„æ•¸å€¼ä¿è­‰
- **æ¸¬è©¦**: ç°¡å–®é©—è­‰ â†’ ä¼æ¥­ç´šå®Œæ•´æ¸¬è©¦é«”ç³»

é€™å¥—v2.0ä¼æ¥­ç´šæŠ€è¡“é«”ç³»ç‚ºå’–å•¡æ²–æ³¡éç¨‹æä¾›äº†å‰æ‰€æœªæœ‰çš„å·¥æ¥­ç´šæ•¸å€¼æ¨¡æ“¬èƒ½åŠ›ï¼Œç‚ºå„ªåŒ–èƒå–æŠ€è¡“ã€è¨­å‚™è¨­è¨ˆå’Œç”¢å“é–‹ç™¼æä¾›äº†å¼·å¤§çš„ç§‘å­¸å·¥å…·åŸºç¤ã€‚

---

**åƒè€ƒæ–‡ç»**:
1. Chen, S. & Doolen, G.D. (1998). Lattice Boltzmann method for fluid flows. *Annu. Rev. Fluid Mech.*, 30, 329-364.
2. Sukop, M.C. & Thorne, D.T. (2006). *Lattice Boltzmann modeling*. Springer.
3. KrÃ¼ger, T. et al. (2017). *The lattice Boltzmann method*. Springer.
4. Bear, J. (1972). *Dynamics of fluids in porous media*. American Elsevier.
5. NIST Chemistry WebBook - Thermophysical Properties of Fluid Systems

*Â© 2025 Pour-Over Coffee LBM Simulation Project v2.0 | ä¼æ¥­ç´šCFDç³»çµ± | ä½¿ç”¨ opencode + GitHub Copilot é–‹ç™¼*